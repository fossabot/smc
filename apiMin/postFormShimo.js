var AV=require("leanengine"),http=require("request"),filename=__filename.split("/").pop().split(".js").shift();async function postFormShimo(e){var a=await AV.Cloud.run("getShimoTokenRaw"),t=e.params.data,p=e.params.filename;return new Promise((i,n)=>{const o=http.post({url:"https://uploader.shimo.im/upload2"},function(a,t,n){var o=JSON.parse(n),s=p.split("."),r=s.pop(),m=s.join(".");o.data.type=r,o.data.name=m,o.class=e.params.class,o.lottieURL=e.params.lottieURL;var l=AV.Cloud.run("updateShimo",o);i(l)}).form();o.append("server","qiniu"),o.append("type","attachments"),o.append("accessToken",a),o.append("file",t,{filename:p})})}AV.Cloud.define(filename,e=>postFormShimo(e));