var http=require("request");async function postFormShimo(a){var e=await AV.Cloud.run("getShimoTokenRaw"),t=a.params.data,n=a.params.filename;return new Promise((o,r)=>{const p=http.post({url:"https://uploader.shimo.im/upload2"},function(e,t,r){var p=JSON.parse(r),i=n.split("."),s=i.pop(),m=i.join(".");p.data.type=s,p.data.name=m,p.class=a.params.class,p.lottieURL=a.params.lottieURL;var u=AV.Cloud.run("updateShimo",p);o(u)}).form();p.append("server","qiniu"),p.append("type","attachments"),p.append("accessToken",e),p.append("file",t,{filename:n})})}var AV=require("leanengine");AV.Cloud.define("postFormShimo",async function(a){return await postFormShimo(a)});